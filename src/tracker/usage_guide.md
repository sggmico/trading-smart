# 币安多账户持仓查看工具

## 功能特点

✅ 同时查看多个币安账户
✅ 现货账户余额查询
✅ 合约持仓情况查询
✅ 合约账户余额统计
✅ 未实现盈亏汇总

## 安装依赖

```bash
pip install requests
```

无需其他依赖,使用原生 requests 库直接调用币安API。

## 使用步骤

### 1. 获取API密钥

登录币安账户,获取API Key和Secret Key:

1. 访问 https://www.binance.com/zh-CN/my/settings/api-management
2. 创建新的API密钥
3. 设置权限（建议只开启"读取"权限）
4. 保存API Key和Secret Key

⚠️ **安全建议**:
- 只启用"读取"权限,不要启用"提现"
- 不要分享你的API密钥
- 建议绑定IP地址限制

### 2. 配置账户信息

复制配置示例文件并编辑:

```bash
cp config_example.py config_local.py
```

在 `config_local.py` 文件中填入你的API密钥:

```python
ACCOUNTS = [
    {
        "name": "账户1",
        "api_key": "你的API_KEY",
        "api_secret": "你的API_SECRET",
        "testnet": False
    },
    {
        "name": "账户2",
        "api_key": "你的API_KEY",
        "api_secret": "你的API_SECRET",
        "testnet": False
    },
]
```

### 3. 运行脚本

```bash
python run_viewer.py
```

## 输出示例

```
================================================================================
币安多账户持仓查询 - 2024-11-04 15:30:00
================================================================================

📊 正在查询 账户1...
📊 正在查询 账户2...

================================================================================
📈 现货账户余额
================================================================================
账户    币种    可用        冻结    总计
账户1   USDT    1000.50     0.00    1000.50
账户1   BTC     0.05        0.00    0.05
账户2   USDT    500.00      0.00    500.00

总计 3 个币种持仓

================================================================================
🔮 合约持仓情况
================================================================================
账户    交易对      持仓量    入场价    标记价格    未实现盈亏    杠杆
账户1   BTCUSDT     0.1      65000     66000       100.00       10
账户2   ETHUSDT     -2.0     3500      3450        100.00       5

总未实现盈亏: 200.00 USDT

================================================================================
💰 合约账户余额
================================================================================
账户    总余额      可用余额    未实现盈亏
账户1   5000.00    4500.00     100.00
账户2   3000.00    2800.00     100.00

所有账户总余额: 8000.00 USDT
```

## 进阶功能

### 定时查询

使用cron或Windows任务计划程序定时运行:

```bash
# Linux/Mac - 每小时查询一次
0 * * * * cd /path/to/tracker && /usr/bin/python3 run_viewer.py

# Windows - 使用任务计划程序
```

### 导出到Excel

修改脚本,添加Excel导出功能:

```python
# 在main函数末尾添加
df_spot.to_excel('spot_balance.xlsx', index=False)
df_futures.to_excel('futures_positions.xlsx', index=False)
```

### 价格提醒

可以基于此脚本扩展,添加:
- 持仓市值监控
- 盈亏比例提醒
- 价格异动通知

## 常见问题

**Q: 提示"API key权限不足"**  
A: 请确保API密钥已启用"现货及杠杆交易"和"合约交易"的读取权限

**Q: 连接超时**  
A: 可能是网络问题,可以尝试使用代理或切换网络

**Q: 如何只查看特定币种?**  
A: 修改 `get_spot_balance` 函数,添加币种过滤逻辑

**Q: 数据不准确?**  
A: 确保服务器时间同步,币安API对时间要求较严格

## 安全注意事项

🔒 **重要提醒**:
1. 永远不要将API密钥上传到GitHub等公共平台
2. 建议使用只读权限的API密钥
3. 定期更换API密钥
4. 启用IP白名单限制
5. 不要在公共电脑上运行此脚本

## 许可

此工具仅供个人学习和使用,请遵守币安API使用条款。